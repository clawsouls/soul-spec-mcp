# soul-spec-mcp 동작 테스트 (Clean Environment)

## 사전 조건
- macOS (clean 상태)
- Node.js 18+ 설치
- Claude Desktop (Max 구독) 또는 Claude Code

---

## Test 1: npx 실행 확인

```bash
npx -y soul-spec-mcp --help
```

**기대**: 프로세스 시작 (MCP 서버라 stdin 대기 상태로 멈춤 → Ctrl+C로 종료). 에러 없으면 OK.

---

## Test 2: Claude Code에서 MCP 등록 + tool 호출

### 2-1. MCP 등록
```bash
claude mcp add soul-spec -- npx -y soul-spec-mcp
```

### 2-2. Claude Code 시작
```bash
claude
```

### 2-3. search_souls 테스트
Claude에게:
> "Search for coding personas"

**기대**: 검색 결과 목록 (이름, 설명, 카테고리, 다운로드 수)

### 2-4. get_soul 테스트
> "Tell me about TomLeeLive/brad"

**기대**: Brad 상세 정보 (v1.2.0, Apache-2.0, work/engineering 등)

### 2-5. preview_soul 테스트
> "Preview the surgical-coder soul as CLAUDE.md"

**기대**: CLAUDE.md 마크다운 미리보기 출력

### 2-6. install_soul 테스트
> "Install TomLeeLive/brad to ./test-soul folder"

**기대**:
- `./test-soul/CLAUDE.md` 파일 생성됨
- 파일 내용에 "Brad", "Persona", "Workflow" 섹션 포함

### 2-7. list_categories 테스트
> "What persona categories are available?"

**기대**: 카테고리 목록 (work/engineering, creative, education 등)

### 2-8. MCP 제거 (정리)
```bash
claude mcp remove soul-spec
```

---

## Test 3: Claude Desktop에서 MCP 등록 + tool 호출

### 3-1. 설정 파일 편집
```bash
# macOS
code ~/Library/Application\ Support/Claude/claude_desktop_config.json
```

추가:
```json
{
  "mcpServers": {
    "soul-spec": {
      "command": "npx",
      "args": ["-y", "soul-spec-mcp"]
    }
  }
}
```

### 3-2. Claude Desktop 재시작

### 3-3. 대화창에서 테스트
> "Search for creative personas on Soul Spec"

**기대**: MCP tool 호출되어 결과 표시

### 3-4. 설치 테스트
> "Install TomLeeLive/brad to my Desktop"

**기대**: `~/Desktop/CLAUDE.md` 생성

### 3-5. 설정 제거 (정리)
`claude_desktop_config.json`에서 `soul-spec` 항목 삭제 후 재시작

---

## Test 4: 생성된 CLAUDE.md 검증

Test 2-6에서 생성된 파일 확인:

```bash
cat ./test-soul/CLAUDE.md
```

**체크리스트:**
- [ ] `# Brad v1.2.0` 헤더
- [ ] `> Formal, competent development partner` 설명
- [ ] `<!-- Generated by Soul Spec MCP -->` 코멘트
- [ ] `<!-- Source: https://clawsouls.ai -->` 코멘트
- [ ] `## Persona` 섹션 (SOUL.md 내용)
- [ ] `## Identity` 섹션 (IDENTITY.md 내용)
- [ ] `## Communication Style` 섹션 (STYLE.md 내용)
- [ ] `## Workflow` 섹션 (AGENTS.md 내용)
- [ ] `## Periodic Checks` 섹션 (HEARTBEAT.md 내용)

---

## Test 5: apply_persona (즉시 페르소나 전환)

### 5-1. 페르소나 적용
> "Apply the TomLeeLive/brad persona"

**기대**: Brad의 SOUL.md, IDENTITY.md, STYLE.md, AGENTS.md 내용이 출력되고, "Persona Brad is now active" 메시지

### 5-2. 적용 후 동작 확인
> "Introduce yourself"

**기대**: Brad 페르소나로 응답 (formal, concise, no fluff)

### 5-3. 다른 페르소나로 전환
> "Apply clawsouls/backend-dev persona"

**기대**: 새 페르소나로 전환됨

---

## Test 6: 에러 핸들링

### 6-1. 존재하지 않는 soul
> "Get details about nonexistent/fake-soul"

**기대**: 에러 메시지 (크래시 아님)

### 6-2. 빈 검색
> "Search for xyznonexistent123"

**기대**: "No souls found" 메시지

---

## 결과 요약

| # | 테스트 | 결과 |
|---|--------|------|
| 1 | npx 실행 | ⬜ |
| 2-1 | claude mcp add | ⬜ |
| 2-3 | search_souls | ⬜ |
| 2-4 | get_soul | ⬜ |
| 2-5 | preview_soul | ⬜ |
| 2-6 | install_soul | ⬜ |
| 2-7 | list_categories | ⬜ |
| 3-1~3 | Claude Desktop 연동 | ⬜ |
| 3-4 | Desktop install | ⬜ |
| 4 | CLAUDE.md 내용 검증 | ⬜ |
| 5-1 | apply_persona | ⬜ |
| 5-2 | 적용 후 동작 확인 | ⬜ |
| 5-3 | 페르소나 전환 | ⬜ |
| 6-1 | 없는 soul 에러 | ⬜ |
| 6-2 | 빈 검색 결과 | ⬜ |
